# 1. 프로세스와 스레드
## 1.1 프로세스
**프로그램이 실행 가능한 형태로 메모리에 올라가게 된 것을 프로세스라고 부른다.** 프로세스는 하나의 “작업 단위”이다. <br>

시분할 시스템 환경에선 여러 프로세스들이 CPU를 번갈아 가면서 점유하는 방식으로 프로그램이 실행되는데, **다시 자신의 점유 차례가 되었을 때 진행중이었던 상황을 재현하기 위해 “실행 문맥”을 저장한다.** ~~(당연히 어디까지 했는지 적어둘 곳이 필요)~~ <br>

Process Context는 해당 프로세스의 PC가 가리키고 있는 주소 공간, Stack 영역의 상태, 레지스터의 상태 등의 “현재 상황을 규명하기 위한” 다양한 정보들을 저장한다. <br>
**이러한 문맥은 PCB라는 자료구조에 저장된다.** <br> <br>

1. 하드웨어 문맥 : CPU 수행상태 (PC, Register 등)
2. 프로세스 주소 공간 : code-data-stack 3가지 공간으로 구성된 주소공간의 상태, 프로세스 관리를 위한 PCB
3. 커널상 문맥

<br>

## 1.2 스레드

![image](https://github.com/binary-ho/Save-Me-Speedwagon/assets/71186266/38e418eb-6969-4f55-b7cb-db3ac1918741)

<br>

스레드는 하나의 프로세스가 할당 받은 자원들을 이용하는 **“실행 단위”** 로, 프로세스 내에 여러개 존재할 수 있으며, 각자의 Stack Segment를 할당 받는다. (나머지는 공유한다.) 자신만의 콜 스택이 존재하는 덕분에, 독립적인 함수 호출이 가능하다. <br>

<br>

위 그림에서 보인 것과 같이 주소공간 중 **code영역, data 영역을 공유한다** <br>
그리고 각자의 스택 세그먼트를 가지고 있는데 덕분에 각 스레드별로 자신만의 흐름 진행이 가능하다. <br>
-> 자신만의 스택 프레임을 쌓을 수 있으니까 <br>

~~스레드를 자세히 설명하기보단, 프로세스와의 공통점과 차이점을 기재~~

<br>

## 2. 프로세스 vs 스레드
### 2.1 공통점과 차이점
1. 공통점 : 시분할 시스템에서 프로그램을 병렬로 실행할 수 있다는 것 자체가 장점이다.
2. 차이점 : **독립된 메모리 공간이냐, 공유하는 부분이 있냐가 핵심. 결국 컨텍스트 스위칭의 차이점 대부분은 여기에서 나온다**

<br>

**이제 멀티 프로세스와 멀티 스레드의 컨텍스트 스위칭의 차이를 알아보자.**

<br>

### 2.2 스레드간 스위칭이 나은 점


1. **스레드간 스위칭이 더 가볍고, 자원의 효율적 사용이 가능.** <br>
  -> 공유 영역 덕분 <br>
  -> TCB가 훨씬 가볍다. **PCB 저장 및 복원 비용 보다 가볍다** <br>

2. **CPU 캐시 메모리 무효화 없음** 프로세스 단위로 캐싱하기 때문
3. 자원 공유가 효율적이다. → 프로세스간 통신은 IPC로 통신해야함. (메모리 공간이 독립적이잖아)

<br>

### 2.3 스레드간 스위칭 단점
결국 heap 영역 등을 공유하며 Race Condition이 발생할 수 있다는 것이 핵심이다. <br>

1. Race Condition 발생 : 스레드간 컨텍스트 스위칭 상황에서는 데이터를 공유하기 때문에, Race Condition이 발생할 수 있다. 프로세스도 파일 시스템 접근시 발생할 수 있지만, 일반적으론 적다.
2. 동기화로 인한 성능 저하 + 데드락
3. 관련되지 않은 단점 : 비정상적인 프로세스 종료 상황에서 스레드 전체가 종료되어서 위험 <br> (프로세스는 각자 독립적인 메모리 공간을 가지기 때문에, 비교적 안전 **비정상 종료 상황에서 안전)**

## 3. Feat

### 3.1 PCB
컨텍스트를 저장함. 스위칭시 활용하고 저장 및 복원 오버헤드가 있다.

(기억 안 나는건 찾아보기)

1. Process State
2. PC: Program Counter의 Value
3. CPU Register의 Value
4. CPU Scheduling information
5. Memory Management Information
6. Accounting Information: 자원 사용 정보
7. I/O Status Information

### 3.2 프로세스 주소공간 Segmment
